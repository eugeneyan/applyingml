{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/resources/patterns/",
    "result": {"data":{"mdx":{"frontmatter":{"title":"Design Patterns in Machine Learning Code and Systems","description":"Understanding and spotting patterns to use code and components as intended.","name":null,"role":null,"slug":"/resources/patterns/","type":"resource"},"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Design Patterns in Machine Learning Code and Systems\",\n  \"description\": \"Understanding and spotting patterns to use code and components as intended.\",\n  \"date\": \"2022-06-12\",\n  \"slug\": \"/resources/patterns/\",\n  \"type\": \"resource\",\n  \"homepage\": true\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Design patterns are not just a way to structure code. They also communicate the problem addressed and how the code or component is intended to be used.\"), mdx(\"p\", null, \"Here are some patterns I've observed in machine learning code and systems, mostly from the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Design_Patterns\"\n  }, \"Gang of Four design patterns book\"), \". Most developers have some familiarity with these patterns and having a basic understanding provides a shared vocabulary to discuss ideas on design and implementation.\"), mdx(\"h2\", {\n    \"id\": \"design-patterns-in-libraries-and-code\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Design patterns in libraries and code\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#design-patterns-in-libraries-and-code\",\n    \"aria-label\": \"design patterns in libraries and code permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"height\": \"20px\",\n    \"width\": \"20px\",\n    \"style\": {\n      \"verticalAlign\": \"-10%\",\n      \"marginLeft\": \"0.25rem\"\n    },\n    \"fill\": \"#007bff\",\n    \"x\": \"0px\",\n    \"y\": \"0px\",\n    \"viewBox\": \"0 0 100 100\",\n    \"enableBackground\": \"new 0 0 100 52\",\n    \"xmlSpace\": \"preserve\"\n  }, mdx(\"g\", {\n    parentName: \"svg\",\n    \"transform\": \"matrix(0.6136733,-0.6136733,0.6136733,0.6136733,4.0598725,65.6509)\"\n  }, mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 47.807,33.138 c 0.008,-0.009 0.016,-0.019 0.024,-0.026 -0.009,0.007 -0.018,0.015 -0.026,0.023 0,0.001 10e-4,0.002 0.002,0.003 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 53.048,49.8 c -0.274,-0.071 -0.545,-0.152 -0.815,-0.232 -0.002,0.001 -0.005,0.003 -0.007,0.003 0.259,0.077 0.534,0.155 0.822,0.229 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 36.33,35.501 h -0.004 c 0.204,0.522 0.496,1.114 0.783,1.651 h 0.013 c -0.284,-0.54 -0.548,-1.09 -0.792,-1.651 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 37.108,37.152 c 0.291,0.544 0.577,1.029 0.758,1.332 -0.263,-0.436 -0.508,-0.882 -0.746,-1.332 h -0.012 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 38.062,38.804 h 0.006 c -0.048,-0.079 -0.1,-0.152 -0.147,-0.231 0.087,0.144 0.141,0.231 0.141,0.231 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 51.812,49.445 c -0.631,-0.197 -1.249,-0.424 -1.856,-0.669 -0.003,0.002 -0.007,0.003 -0.009,0.004 0.06,0.025 0.781,0.324 1.865,0.665 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 52.226,49.57 c 0.002,0 0.005,-0.002 0.007,-0.003 -0.106,-0.03 -0.213,-0.057 -0.318,-0.091 0.101,0.033 0.205,0.065 0.311,0.094 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"M 74.458,0.955 H 59.321 c -1.307,0 -2.591,0.1 -3.845,0.293 -0.273,0.042 -0.541,0.101 -0.811,0.151 4.646,2.666 8.469,6.605 10.987,11.343 h 1.238 8.346 c 7.322,0 13.257,5.937 13.257,13.259 0,7.321 -5.936,13.258 -13.257,13.258 H 65.72 63.762 61.857 61.851 58.68 c -3.305,0 -6.324,-1.212 -8.646,-3.212 0,0 -0.003,0.003 -0.003,0.003 0,-0.002 -10e-4,-0.002 -0.002,-0.003 -0.494,-0.414 -0.886,-0.802 -1.206,-1.148 -0.7,-0.764 -1.011,-1.303 -1.011,-1.303 0.001,-0.002 0.002,-0.002 0.002,-0.003 -10e-4,-0.001 -0.002,-0.002 -0.002,-0.003 -1.505,-2.15 -2.389,-4.766 -2.389,-7.589 0,-2.746 0.834,-5.296 2.263,-7.413 0.041,-0.06 0.086,-0.117 0.127,-0.176 -1.736,-1.473 -3.978,-2.367 -6.429,-2.367 h -5.041 c -1.325,3.052 -2.067,6.416 -2.067,9.956 0,3.538 0.737,6.903 2.061,9.955 0.244,0.561 0.509,1.111 0.792,1.651 0.237,0.45 0.482,0.896 0.746,1.332 0.02,0.033 0.036,0.059 0.054,0.088 0.047,0.079 0.099,0.152 0.147,0.231 2.792,4.463 6.948,7.98 11.888,9.973 0.608,0.245 1.226,0.472 1.856,0.669 0.034,0.011 0.068,0.022 0.103,0.031 0.105,0.034 0.212,0.061 0.318,0.091 0.27,0.08 0.541,0.161 0.815,0.232 0.004,0 0.006,0.002 0.01,0.003 2,0.513 4.096,0.787 6.254,0.787 H 74.457 C 88.289,51.044 99.501,39.831 99.501,26 99.502,12.169 88.29,0.955 74.458,0.955 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 25.542,51.045 h 15.137 c 1.308,0 2.592,-0.101 3.846,-0.294 0.273,-0.042 0.542,-0.1 0.811,-0.151 C 40.69,47.935 36.866,43.996 34.349,39.258 H 33.11 24.764 c -7.322,0 -13.257,-5.936 -13.257,-13.259 0,-7.322 5.935,-13.257 13.257,-13.257 h 9.516 1.957 1.905 0.007 3.17 c 3.304,0 6.323,1.212 8.645,3.212 l 0.002,-0.003 c 10e-4,10e-4 10e-4,0.002 0.002,0.003 0.495,0.413 0.887,0.801 1.206,1.148 0.701,0.762 1.011,1.302 1.011,1.302 0,0.001 -0.001,0.002 -0.002,0.003 10e-4,0 0.002,0.001 0.003,0.003 1.505,2.15 2.39,4.766 2.39,7.588 0,2.746 -0.835,5.297 -2.264,7.412 -0.041,0.062 -0.085,0.118 -0.127,0.176 1.736,1.474 3.979,2.369 6.429,2.369 h 5.042 c 1.324,-3.053 2.065,-6.417 2.065,-9.957 0,-3.539 -0.737,-6.903 -2.061,-9.955 C 63.416,15.482 63.151,14.932 62.868,14.392 62.631,13.941 62.386,13.494 62.122,13.06 62.102,13.027 62.086,13 62.069,12.971 62.021,12.893 61.97,12.818 61.922,12.741 59.13,8.278 54.973,4.76 50.034,2.768 49.426,2.523 48.808,2.297 48.178,2.098 48.144,2.087 48.11,2.077 48.075,2.066 47.97,2.034 47.863,2.007 47.757,1.977 47.487,1.896 47.216,1.815 46.941,1.745 46.937,1.744 46.935,1.744 46.932,1.743 44.932,1.228 42.837,0.955 40.677,0.955 H 25.542 c -13.832,0 -25.044,11.212 -25.044,25.044 0,13.833 11.212,25.046 25.044,25.046 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"M 53.058,49.803 C 53.055,49.802 53.052,49.8 53.048,49.8 c 0.004,0 0.007,0.002 0.01,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 51.812,49.445 c 0.034,0.011 0.068,0.022 0.103,0.031 -0.034,-0.008 -0.068,-0.02 -0.103,-0.031 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 47.805,33.141 c 0,0 0.311,0.539 1.011,1.303 0.005,-0.006 0.01,-0.012 0.016,-0.015 -0.369,-0.407 -0.709,-0.84 -1.025,-1.291 0,0.001 -0.001,0.001 -0.002,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 37.92,38.572 c -0.018,-0.029 -0.034,-0.055 -0.054,-0.088 0.019,0.03 0.036,0.058 0.054,0.088 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 48.832,34.429 c -0.006,0.003 -0.011,0.009 -0.016,0.015 0.319,0.347 0.711,0.734 1.206,1.148 0.001,-0.002 0.002,-0.003 0.002,-0.003 -0.42,-0.362 -0.82,-0.749 -1.192,-1.16 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 50.027,35.592 c 10e-4,-0.003 0.004,-0.006 0.012,-0.015 -0.004,0.004 -0.01,0.008 -0.015,0.012 10e-4,0 0.002,0.001 0.003,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"rect\", {\n    parentName: \"g\",\n    \"height\": \"0.004007bff2\",\n    \"width\": \"0.004007bff2\",\n    \"y\": \"35.59\",\n    \"x\": \"50.021999\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }))))), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The factory pattern decouples objects, such as training data, from how they are created.\"), \" Creating these objects can sometimes be complex (e.g., distributed data loaders) and providing a base factory helps users by simplifying object creation and providing constraints that prevent mistakes.\"), mdx(\"p\", null, \"The base factory can be defined via an interface or abstract class. Then, to create a new factory, we can subclass it and provide our own implementation details.\"), mdx(\"p\", null, \"PyTorch's \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"Dataset\")), \" is a good example. To create our own datasets, we should subclass \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Dataset\"), \" and override the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"__len__\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"__getitem__\"), \" methods. The former returns the size of the dataset while the latter supports indexing to get the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"i\"), \" th example. Here's an \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/eugeneyan/recsys-nlp-graph/blob/master/src/ml/data_loader.py#L237\"\n  }, \"example\"), \" of creating a custom dataset.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"from torch.utils.data import Dataset\\n\\nclass SequencesDataset(Dataset):\\n    def __init__(self, sequences: Sequences, neg_sample_size=5):\\n        self.sequences = sequences\\n        self.neg_sample_size = neg_sample_size\\n\\n    def __len__(self):\\n        return self.sequences.n_sequences\\n\\n    def __getitem__(self, idx):\\n        pairs = self.sequences.get_pairs(idx)\\n        neg_samples = []\\n        for center, context in pairs:\\n            neg_samples.append(self.sequences.get_negative_samples(context))\\n\\n        return pairs, neg_samples\\n\")), mdx(\"p\", null, \"Gensim's \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://radimrehurek.com/gensim/corpora/textcorpus.html\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"textcorpus\")), \" is another example. It simplifies reading text files for downstream language modeling. Users need to override the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"get_texts()\"), \" method to read and process a single line (or document) and return it as a sequence of words.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"from gensim.corpora.textcorpus import TextCorpus\\nfrom gensim.test.utils import datapath\\nfrom gensim import utils\\n\\nclass CorpusMiislita(TextCorpus):\\n    stopwords = set('for a of the and to in on'.split())\\n    \\n    def get_texts(self):\\n        for doc in self.getstream():\\n            yield [word for word in utils.to_unicode(doc).lower().split() if word not in self.stopwords]\\n\\n    def __len__(self):\\n        self.length = sum(1 for _ in self.get_texts())\\n        return self.length\\n\\ncorpus = CorpusMiislita(datapath('head500.noblanks.cor.bz2'))\\n>>> len(corpus)\\n250\\ndocument = next(iter(corpus.get_texts()))\\n\")), mdx(\"p\", null, \"A final example is Hugging Face's \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://huggingface.co/docs/datasets/loading\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"Dataset\")), \" that doesn't require subclassing. It provides a simple way for users to load data into Apache Arrow which provides for fast lookup with low memory requirements. It also includes methods to stream, interleave, shuffle, etc.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"from datasets import load_dataset\\nfrom datasets import interleave_datasets\\n\\n# Load as streaming = True\\nen_dataset = load_dataset('oscar', \\\"unshuffled_deduplicated_en\\\", split='train', streaming=True)\\nfr_dataset = load_dataset('oscar', \\\"unshuffled_deduplicated_fr\\\", split='train', streaming=True)\\n\\n# Interleave\\nmultilingual_dataset = interleave_datasets([en_dataset, fr_dataset])\\n\\n# Shuffle\\nshuffled_dataset = multilingual_dataset.shuffle(seed=42, buffer_size=10_000)\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The adapter pattern increases compatibility between interfaces\"), \", such as data formats like CSV, Parquet, JSON, etc. This allows objects (e.g., stored data) with incompatible interfaces to collaborate. Specific to data pipelines, adapters are often used to read data stored in different formats into a standard data object such as a Dataframe.\"), mdx(\"p\", null, \"For example, Pandas has almost 20 adapters to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pandas.pydata.org/docs/user_guide/io.html\"\n  }, \"read\"), \" most file storages types into the pandas Dataframe.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"700px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"87.99999999999999%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3gUEBQf/xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAEFAh//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAYEAADAQEAAAAAAAAAAAAAAAAAAUExEP/aAAgBAQABPyFdWlEUosP/2gAMAwEAAgADAAAAEFMPgP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABsQAAMAAwEBAAAAAAAAAAAAAAABMSFBcRGx/9oACAEBAAE/EEyvPpt2CiGw4OuEIUG3CB//2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Non-exhaustive list of adapters to read different file storage formats in Pandas\",\n    \"title\": \"Non-exhaustive list of adapters to read different file storage formats in Pandas\",\n    \"src\": \"/static/958aae8d8dcdcc3c5fa71bbbac6783be/29d31/pandas_read.jpg\",\n    \"srcSet\": [\"/static/958aae8d8dcdcc3c5fa71bbbac6783be/e52aa/pandas_read.jpg 175w\", \"/static/958aae8d8dcdcc3c5fa71bbbac6783be/70ebb/pandas_read.jpg 350w\", \"/static/958aae8d8dcdcc3c5fa71bbbac6783be/29d31/pandas_read.jpg 700w\", \"/static/958aae8d8dcdcc3c5fa71bbbac6783be/9ecec/pandas_read.jpg 1050w\", \"/static/958aae8d8dcdcc3c5fa71bbbac6783be/e5166/pandas_read.jpg 1200w\"],\n    \"sizes\": \"(max-width: 700px) 100vw, 700px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(FigureCaption, {\n    caption: \"Non-exhaustive list of adapters to read different file storage formats in Pandas\",\n    mdxType: \"FigureCaption\"\n  }), mdx(\"p\", null, \"Similarly, Spark has adapters to read from different data formats such as \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://spark.apache.org/docs/latest/sql-data-sources-parquet.html\"\n  }, \"Parquet\"), \", \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://spark.apache.org/docs/latest/sql-data-sources-json.html\"\n  }, \"JSON\"), \", \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://spark.apache.org/docs/latest/sql-data-sources-csv.html\"\n  }, \"CSV\"), \", \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://spark.apache.org/docs/latest/sql-data-sources-hive-tables.html\"\n  }, \"Hive\"), \", and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://spark.apache.org/docs/latest/sql-data-sources-text.html\"\n  }, \"Text\"), \" files.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-scala\"\n  }, \"val parquetDf = spark.read.parquet(\\\"people.parquet\\\")\\nval jsonDf = spark.read.json(\\\"examples/src/main/resources/people.json\\\")\\nval hiveDF = sql(\\\"SELECT name, job_family FROM people WHERE age < 60 ORDER BY age\\\")\\nval csvDf = spark.read.csv(\\\"examples/src/main/resources/people.csv\\\")\\nval textDf = spark.read.text(\\\"examples/src/main/resources/people.txt\\\")\\n\")), mdx(\"p\", null, \"Another example is \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://arrow.apache.org/overview/\"\n  }, \"Apache Arrow\"), \" which provides a standard columnar format across multiple data frameworks like Pandas, Spark, Parquet, Cassandra, and more. (Hugging Face's Dataset uses Arrow for its local caching system.)\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"700px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"55.42857142857143%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHtrE0ov//EABkQAAIDAQAAAAAAAAAAAAAAAAABAhExEv/aAAgBAQABBQLSiOOKZxG0qP/EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/AYf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGn/8QAGxAAAQQDAAAAAAAAAAAAAAAAAAEQETEhIkH/2gAIAQEABj8CXY6XJTYP/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARITFhUUH/2gAIAQEAAT8h2GfDZPVij6xXp7IM+t1iBBpwVtgCgByf/9oADAMBAAIAAwAAABAI/wD/xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPxAj/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAEx/9oACAECAQE/EC6//8QAGxAAAgMBAQEAAAAAAAAAAAAAAREAITFBYaH/2gAIAQEAAT8QrPe4FnlwIXrjaM0iXOzgvkHJEdrDb0XGBCgzBJWGjOmKQIT/2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Apache Arrow standardizes in-memory columnar data for several data frameworks\",\n    \"title\": \"Apache Arrow standardizes in-memory columnar data for several data frameworks\",\n    \"src\": \"/static/4c787f260248f3ab126d5f46a7c926d3/29d31/arrow.jpg\",\n    \"srcSet\": [\"/static/4c787f260248f3ab126d5f46a7c926d3/e52aa/arrow.jpg 175w\", \"/static/4c787f260248f3ab126d5f46a7c926d3/70ebb/arrow.jpg 350w\", \"/static/4c787f260248f3ab126d5f46a7c926d3/29d31/arrow.jpg 700w\", \"/static/4c787f260248f3ab126d5f46a7c926d3/4b190/arrow.jpg 800w\"],\n    \"sizes\": \"(max-width: 700px) 100vw, 700px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(FigureCaption, {\n    caption: \"Apache Arrow standardizes in-memory columnar data for several data frameworks\",\n    mdxType: \"FigureCaption\"\n  }), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The decorator pattern allows users to easily add functionality to their existing code.\"), \" Objects can be \\u201Cdecorated\\u201D (aka adding functionality) at run time without having to update the structure or behavior of other objects of the same class.\"), mdx(\"p\", null, \"In Python, decorating methods is easy via the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@\"), \" syntax. Applying \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@decorator\"), \" on \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"method()\"), \" is equivalent to calling \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"method = decorator(method)\"), \".\"), mdx(\"p\", null, \"A handy example of a built-in operator is functool's \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.python.org/3/library/functools.html#functools.lru_cache\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"lru_cache()\")), \". It saves the most recent \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"x\"), \" calls in a dictionary which maps input arguments to returned results. Here's an example using cache to efficiently compute Fibonacci numbers.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"from functools import lru_cache\\n\\n@lru_cache(maxsize=None)\\ndef fib(n):\\n    if n < 2:\\n        return n\\n    return fib(n-1) + fib(n-2)\\n\\n>>> [fib(n) for n in range(16)]\\n[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610]\\n\\n>>> fib.cache_info()\\nCacheInfo(hits=28, misses=16, maxsize=None, currsize=16)\\n\")), mdx(\"p\", null, \"Another example is \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.pytest.org/en/7.1.x/index.html\"\n  }, \"Pytest's\"), \" decorators to define \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.pytest.org/en/6.2.x/fixture.html\"\n  }, \"fixtures\"), \". These fixtures can then be referenced in downstream tests. Think of fixtures as methods that generate data for testing expected behavior. These fixtures are called before running any tests and shared across tests. Here are some \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/eugeneyan/testing-ml/blob/master/tests/tree/fixtures.py\"\n  }, \"examples\"), \" of fixtures to load sample data and trained models.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"import pytest\\nimport numpy as np\\n\\nfrom src.data_prep.prep_titanic import load_df, prep_df, split_df, get_feats_and_labels\\nfrom src.tree.decision_tree import DecisionTree\\nfrom src.tree.random_forest import RandomForest\\n\\n# Returns data for training and evaluating our models\\n@pytest.fixture\\ndef dummy_dataset():\\n    df = load_df()\\n    df = prep_df(df)\\n\\n    train, test = split_df(df)\\n    X_train, y_train = get_feats_and_labels(train)\\n    X_test, y_test = get_feats_and_labels(test)\\n    return X_train, y_train, X_test, y_test\\n\\n# Returns a trained DecisionTree that is evaluated on implementation and behavior\\n@pytest.fixture\\ndef dummy_decision_tree(dummy_dataset):\\n    X_train, y_train, _, _ = dummy_dataset\\n    dt = DecisionTree(depth_limit=5)\\n    dt.fit(X_train, y_train)\\n    return dt\\n\\n# Returns a trained RandomForest that is evaluated on implementation and behavior\\n@pytest.fixture\\ndef dummy_random_forest(dummy_dataset):\\n    X_train, y_train, _, _ = dummy_dataset\\n    rf = RandomForest(num_trees=8, depth_limit=5, col_subsampling=0.8, row_subsampling=0.8)\\n    rf.fit(X_train, y_train)\\n    return rf\\n\")), mdx(\"p\", null, \"A simple decorator I often use is a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/eugeneyan/testing-ml/blob/master/src/utils/timer.py\"\n  }, \"timer\"), \" that measures how long a method call takes and returns the results. This is useful when building prototypes that call different models\\u2014with varying latencies\\u2014to check the time taken for each call.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"from functools import wraps\\nfrom time import perf_counter\\nfrom typing import Callable\\nfrom typing import Tuple\\n\\ndef timer(func: Callable) -> Callable:\\n    @wraps(func)\\n    def wrapper(*args, **kwargs):\\n        start = perf_counter()\\n        results = func(*args, **kwargs)\\n        end = perf_counter()\\n        run_time = end - start\\n        return results, run_time\\n\\n    return wrapper\\n\\n@timer\\ndef predict_with_time(model, X_test: np.array) -> Tuple[np.array]:\\n    return model.predict(X_test)\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The strategy pattern lets users change the intended behavior or algorithm of an object.\"), \" Users can create new objects for each strategy (aka algorithm) and depending on the strategy object used, the context behavior can vary at runtime. This decouples algorithms from clients, adding flexibility and reusability to the code.\"), mdx(\"p\", null, \"Most machine learning libraries come with builtin algorithms and settings. Nonetheless, they also provide the flexibility for users to add their own algorithms so long as it adheres to the strategy interface.\"), mdx(\"p\", null, \"For example, XGBoost provides \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://xgboost.readthedocs.io/en/stable/treemethod.html\"\n  }, \"various methods\"), \" to construct trees (e.g., exact, approx, hist, gpu\", \"_\", \"hist) and several \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://xgboost.readthedocs.io/en/stable/parameter.html#learning-task-parameters\"\n  }, \"objective functions\"), \" such as squared error, logistic, and pairwise ranking. Nonetheless, we can also provide a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://xgboost.readthedocs.io/en/stable/tutorials/custom_metric_obj.html#customized-objective-function\"\n  }, \"custom objective function\"), \" if we want to, such as the squared log error example below.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"import numpy as np\\nimport xgboost as xgb\\nfrom typing import Tuple\\n\\ndef gradient(predt: np.ndarray, dtrain: xgb.DMatrix) -> np.ndarray:\\n    y = dtrain.get_label()\\n    return (np.log1p(predt) - np.log1p(y)) / (predt + 1)\\n\\ndef hessian(predt: np.ndarray, dtrain: xgb.DMatrix) -> np.ndarray:\\n    y = dtrain.get_label()\\n    return ((-np.log1p(predt) + np.log1p(y) + 1) / np.power(predt + 1, 2))\\n\\ndef squared_log(predt: np.ndarray, dtrain: xgb.DMatrix) -> Tuple[np.ndarray, np.ndarray]:\\n    predt[predt < -1] = -1 + 1e-6\\n    grad = gradient(predt, dtrain)\\n    hess = hessian(predt, dtrain)\\n    return grad, hess\\n\\nxgb.train({'tree_method': 'hist', 'seed': 1994},\\n           dtrain=dtrain,\\n           num_boost_round=10,\\n           obj=squared_log)  # Using the custom objective function\\n\")), mdx(\"p\", null, \"Similarly, Hugging Face's \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://huggingface.co/docs/transformers/main_classes/pipelines\"\n  }, \"pipeline\"), \" makes it easy to use various strategies (aka language models) for inference. Pipelines supports tasks such as sentiment analysis, translation, question answering, and more.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"from transformers import pipeline\\n\\npipe = pipeline(\\\"sentiment-analysis\\\")\\n>>> pipe([\\\"This restaurant is awesome\\\", \\\"This restaurant is aweful\\\"])\\n[{'label': 'POSITIVE', 'score': 0.9998743534088135},\\n {'label': 'NEGATIVE', 'score': 0.9996669292449951}]\\n\\nen_fr_translator = pipeline(\\\"translation_en_to_fr\\\")\\n>>> en_fr_translator(\\\"How old are you?\\\")\\n[{'translation_text': ' quel \\xE2ge \\xEAtes-vous?'}]\\n\\nqa_model = pipeline(\\\"question-answering\\\")\\nquestion = \\\"Where do I live?\\\"\\ncontext = \\\"My name is Merve and I live in \\u0130stanbul.\\\"\\n>>> qa_model(question = question, context = context)\\n{'answer': '\\u0130stanbul', 'end': 39, 'score': 0.953, 'start': 31}\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The iterator pattern provides a way to go through objects in a collection of objects.\"), \" This decouples the traversal algorithm from the data container and users can define their own algorithm. For example, if we have data in a tree, we might want to swap between breadth-first and depth-first traversal.\"), mdx(\"p\", null, \"An example is PyTorch's \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"DataLoader\")), \" which lets users define batch size, shuffling, number of workers, and even provide custom \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pytorch.org/docs/stable/data.html#working-with-collate-fn\"\n  }, \"collate functions\"), \". \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"from torch.utils.data import DataLoader\\n\\ndataset = SequencesDataset(sequences)\\n\\ndef collate(batches):\\n    batch_list = []\\n\\n    for batch in batches:\\n        pairs = np.array(batch[0])\\n        negs = np.array(batch[1])\\n        negs = np.vstack((pairs[:, 0].repeat(negs.shape[1]), negs.ravel())).T\\n\\n        pairs_arr = np.ones((pairs.shape[0], pairs.shape[1] + 1), dtype=int)\\n        pairs_arr[:, :-1] = pairs\\n\\n        negs_arr = np.zeros((negs.shape[0], negs.shape[1] + 1), dtype=int)\\n        negs_arr[:, :-1] = negs\\n\\n        all_arr = np.vstack((pairs_arr, negs_arr))\\n        batch_list.append(all_arr)\\n\\n    batch_array = np.vstack(batch_list)\\n\\n    # Return item1, item2, label\\n    return (torch.LongTensor(batch_array[:, 0]), torch.LongTensor(batch_array[:, 1]),\\n            torch.FloatTensor(batch_array[:, 2]))\\n\\n# We can customize the batch size, number of works, shuffle, etc.\\ntrain_dataloader = DataLoader(dataset, batch_size=128, shuffle=True, num_workers=8, collate_fn=collate)\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The pipeline pattern lets users chain a sequence of transformations.\"), \" Transforms are steps to process the data, such as data cleaning, feature engineering, dimensionality reduction, etc. An estimator (aka machine learning model) can be added to the end of the pipeline. Thus, the pipeline takes data as input, transforms it, and trains a model at the end.\"), mdx(\"p\", null, \"IMHO, in ML pipelines, everything from data preparation to feature engineering to model hyperparameters is a parameter to tune. Being able to chain and vary transforms and estimators makes for convenient pipeline parameter tuning. How would model metrics change if we \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"np.log\"), \" continuous variables or add trigrams to our text features?\"), mdx(\"p\", null, \"When using a pipeline, we should be aware that the input and output of each transform step should have a standardized format, such as a Pandas Dataframe. Also, each transform should have the required methods such as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".fit()\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".transform()\"), \".\"), mdx(\"p\", null, \"Sklearn's \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"Pipeline\")), \" allows users to provide a list of transforms and a final estimator. We can also use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"TransformerMixin\")), \" to create \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.section.io/engineering-education/custom-transformer/\"\n  }, \"custom transforms\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"from sklearn.svm import SVC\\nfrom sklearn.preprocessing import StandardScaler\\nfrom sklearn.impute import SimpleImputer\\nfrom sklearn.datasets import make_classification\\nfrom sklearn.model_selection import train_test_split\\nfrom sklearn.pipeline import Pipeline\\n\\nX, y = make_classification(random_state=0)\\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)\\n\\n# Create and train pipeline\\npipe = Pipeline([('imputer', SimpleImputer(strategy=\\\"median\\\")), \\n                 ('scaler', StandardScaler()), \\n                 ('svc', SVC())])\\npipe.fit(X_train, y_train)\\n\\n# Evaluate the pipeline\\n>>> pipe.score(X_test, y_test)\\n0.88\\n\")), mdx(\"p\", null, \"Spark's MLlib also uses the concept of \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://spark.apache.org/docs/latest/ml-pipeline.html\"\n  }, \"pipelines\"), \" which are built around dataframes, transformers, and estimators.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-scala\"\n  }, \"import org.apache.spark.ml.{Pipeline, PipelineModel}\\nimport org.apache.spark.ml.classification.LogisticRegression\\nimport org.apache.spark.ml.feature.{HashingTF, Tokenizer}\\nimport org.apache.spark.ml.linalg.Vector\\nimport org.apache.spark.sql.Row\\n\\n// Prepare training documents from a list of (id, text, label) tuples.\\nval training = spark.createDataFrame(Seq(\\n  (0L, \\\"a b c d e spark\\\", 1.0),\\n  (1L, \\\"b d\\\", 0.0),\\n  (2L, \\\"spark f g h\\\", 1.0),\\n  (3L, \\\"hadoop mapreduce\\\", 0.0)\\n)).toDF(\\\"id\\\", \\\"text\\\", \\\"label\\\")\\n\\n// Configure an ML pipeline, which consists of three stages: tokenizer, hashingTF, and lr.\\nval tokenizer = new Tokenizer()\\n  .setInputCol(\\\"text\\\")\\n  .setOutputCol(\\\"words\\\")\\nval hashingTF = new HashingTF()\\n  .setNumFeatures(1000)\\n  .setInputCol(tokenizer.getOutputCol)\\n  .setOutputCol(\\\"features\\\")\\nval lr = new LogisticRegression()\\n  .setMaxIter(10)\\n  .setRegParam(0.001)\\nval pipeline = new Pipeline()\\n  .setStages(Array(tokenizer, hashingTF, lr))\\n\\n// Fit the pipeline to training documents.\\nval model = pipeline.fit(training)\\n\\n// Now we can optionally save the fitted pipeline to disk\\nmodel.write.overwrite().save(\\\"/tmp/spark-logistic-regression-model\\\")\\n\")), mdx(\"h2\", {\n    \"id\": \"design-patterns-in-systems\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Design patterns in systems\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#design-patterns-in-systems\",\n    \"aria-label\": \"design patterns in systems permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"height\": \"20px\",\n    \"width\": \"20px\",\n    \"style\": {\n      \"verticalAlign\": \"-10%\",\n      \"marginLeft\": \"0.25rem\"\n    },\n    \"fill\": \"#007bff\",\n    \"x\": \"0px\",\n    \"y\": \"0px\",\n    \"viewBox\": \"0 0 100 100\",\n    \"enableBackground\": \"new 0 0 100 52\",\n    \"xmlSpace\": \"preserve\"\n  }, mdx(\"g\", {\n    parentName: \"svg\",\n    \"transform\": \"matrix(0.6136733,-0.6136733,0.6136733,0.6136733,4.0598725,65.6509)\"\n  }, mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 47.807,33.138 c 0.008,-0.009 0.016,-0.019 0.024,-0.026 -0.009,0.007 -0.018,0.015 -0.026,0.023 0,0.001 10e-4,0.002 0.002,0.003 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 53.048,49.8 c -0.274,-0.071 -0.545,-0.152 -0.815,-0.232 -0.002,0.001 -0.005,0.003 -0.007,0.003 0.259,0.077 0.534,0.155 0.822,0.229 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 36.33,35.501 h -0.004 c 0.204,0.522 0.496,1.114 0.783,1.651 h 0.013 c -0.284,-0.54 -0.548,-1.09 -0.792,-1.651 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 37.108,37.152 c 0.291,0.544 0.577,1.029 0.758,1.332 -0.263,-0.436 -0.508,-0.882 -0.746,-1.332 h -0.012 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 38.062,38.804 h 0.006 c -0.048,-0.079 -0.1,-0.152 -0.147,-0.231 0.087,0.144 0.141,0.231 0.141,0.231 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 51.812,49.445 c -0.631,-0.197 -1.249,-0.424 -1.856,-0.669 -0.003,0.002 -0.007,0.003 -0.009,0.004 0.06,0.025 0.781,0.324 1.865,0.665 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 52.226,49.57 c 0.002,0 0.005,-0.002 0.007,-0.003 -0.106,-0.03 -0.213,-0.057 -0.318,-0.091 0.101,0.033 0.205,0.065 0.311,0.094 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"M 74.458,0.955 H 59.321 c -1.307,0 -2.591,0.1 -3.845,0.293 -0.273,0.042 -0.541,0.101 -0.811,0.151 4.646,2.666 8.469,6.605 10.987,11.343 h 1.238 8.346 c 7.322,0 13.257,5.937 13.257,13.259 0,7.321 -5.936,13.258 -13.257,13.258 H 65.72 63.762 61.857 61.851 58.68 c -3.305,0 -6.324,-1.212 -8.646,-3.212 0,0 -0.003,0.003 -0.003,0.003 0,-0.002 -10e-4,-0.002 -0.002,-0.003 -0.494,-0.414 -0.886,-0.802 -1.206,-1.148 -0.7,-0.764 -1.011,-1.303 -1.011,-1.303 0.001,-0.002 0.002,-0.002 0.002,-0.003 -10e-4,-0.001 -0.002,-0.002 -0.002,-0.003 -1.505,-2.15 -2.389,-4.766 -2.389,-7.589 0,-2.746 0.834,-5.296 2.263,-7.413 0.041,-0.06 0.086,-0.117 0.127,-0.176 -1.736,-1.473 -3.978,-2.367 -6.429,-2.367 h -5.041 c -1.325,3.052 -2.067,6.416 -2.067,9.956 0,3.538 0.737,6.903 2.061,9.955 0.244,0.561 0.509,1.111 0.792,1.651 0.237,0.45 0.482,0.896 0.746,1.332 0.02,0.033 0.036,0.059 0.054,0.088 0.047,0.079 0.099,0.152 0.147,0.231 2.792,4.463 6.948,7.98 11.888,9.973 0.608,0.245 1.226,0.472 1.856,0.669 0.034,0.011 0.068,0.022 0.103,0.031 0.105,0.034 0.212,0.061 0.318,0.091 0.27,0.08 0.541,0.161 0.815,0.232 0.004,0 0.006,0.002 0.01,0.003 2,0.513 4.096,0.787 6.254,0.787 H 74.457 C 88.289,51.044 99.501,39.831 99.501,26 99.502,12.169 88.29,0.955 74.458,0.955 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 25.542,51.045 h 15.137 c 1.308,0 2.592,-0.101 3.846,-0.294 0.273,-0.042 0.542,-0.1 0.811,-0.151 C 40.69,47.935 36.866,43.996 34.349,39.258 H 33.11 24.764 c -7.322,0 -13.257,-5.936 -13.257,-13.259 0,-7.322 5.935,-13.257 13.257,-13.257 h 9.516 1.957 1.905 0.007 3.17 c 3.304,0 6.323,1.212 8.645,3.212 l 0.002,-0.003 c 10e-4,10e-4 10e-4,0.002 0.002,0.003 0.495,0.413 0.887,0.801 1.206,1.148 0.701,0.762 1.011,1.302 1.011,1.302 0,0.001 -0.001,0.002 -0.002,0.003 10e-4,0 0.002,0.001 0.003,0.003 1.505,2.15 2.39,4.766 2.39,7.588 0,2.746 -0.835,5.297 -2.264,7.412 -0.041,0.062 -0.085,0.118 -0.127,0.176 1.736,1.474 3.979,2.369 6.429,2.369 h 5.042 c 1.324,-3.053 2.065,-6.417 2.065,-9.957 0,-3.539 -0.737,-6.903 -2.061,-9.955 C 63.416,15.482 63.151,14.932 62.868,14.392 62.631,13.941 62.386,13.494 62.122,13.06 62.102,13.027 62.086,13 62.069,12.971 62.021,12.893 61.97,12.818 61.922,12.741 59.13,8.278 54.973,4.76 50.034,2.768 49.426,2.523 48.808,2.297 48.178,2.098 48.144,2.087 48.11,2.077 48.075,2.066 47.97,2.034 47.863,2.007 47.757,1.977 47.487,1.896 47.216,1.815 46.941,1.745 46.937,1.744 46.935,1.744 46.932,1.743 44.932,1.228 42.837,0.955 40.677,0.955 H 25.542 c -13.832,0 -25.044,11.212 -25.044,25.044 0,13.833 11.212,25.046 25.044,25.046 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"M 53.058,49.803 C 53.055,49.802 53.052,49.8 53.048,49.8 c 0.004,0 0.007,0.002 0.01,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 51.812,49.445 c 0.034,0.011 0.068,0.022 0.103,0.031 -0.034,-0.008 -0.068,-0.02 -0.103,-0.031 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 47.805,33.141 c 0,0 0.311,0.539 1.011,1.303 0.005,-0.006 0.01,-0.012 0.016,-0.015 -0.369,-0.407 -0.709,-0.84 -1.025,-1.291 0,0.001 -0.001,0.001 -0.002,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 37.92,38.572 c -0.018,-0.029 -0.034,-0.055 -0.054,-0.088 0.019,0.03 0.036,0.058 0.054,0.088 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 48.832,34.429 c -0.006,0.003 -0.011,0.009 -0.016,0.015 0.319,0.347 0.711,0.734 1.206,1.148 0.001,-0.002 0.002,-0.003 0.002,-0.003 -0.42,-0.362 -0.82,-0.749 -1.192,-1.16 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 50.027,35.592 c 10e-4,-0.003 0.004,-0.006 0.012,-0.015 -0.004,0.004 -0.01,0.008 -0.015,0.012 10e-4,0 0.002,0.001 0.003,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"rect\", {\n    parentName: \"g\",\n    \"height\": \"0.004007bff2\",\n    \"width\": \"0.004007bff2\",\n    \"y\": \"35.59\",\n    \"x\": \"50.021999\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }))))), mdx(\"p\", null, \"Beyond being used in code and libraries, I think design patterns also apply to systems. Here are two patterns commonly seen in machine learning systems.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The proxy pattern allows us to provide a substitute for the production database or service.\"), \" The proxy can then perform tasks on behalf of the endpoint.\"), mdx(\"p\", null, \"One example is using a cache proxy to serve search queries. Search queries follow the Pareto principle where a fraction of queries account for the bulk of requests. Thus, by caching results for the top queries (e.g., query suggestion, query classification, retrieval and ranking), we can reduce the amount of compute required for real-time inference.\"), mdx(\"p\", null, \"In the image below, when a request is made, our service first checks if the result is available in the cache. If so, it returns the result from the cache; if not, the query is passed through for real-time inference.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"700px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"25.142857142857146%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG6AD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAZEAACAwEAAAAAAAAAAAAAAAAAUQERIdH/2gAIAQEAAT8h6VLNZ//aAAwDAQACAAMAAAAQc8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhUTFB/9oACAEBAAE/EAsdSl9gC097sG7Y95P/2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Using a cache proxy to serve common requests and reduce compute cost from real-time inference\",\n    \"title\": \"Using a cache proxy to serve common requests and reduce compute cost from real-time inference\",\n    \"src\": \"/static/f625463d16192547fd44d6f40d567cd4/29d31/proxy.jpg\",\n    \"srcSet\": [\"/static/f625463d16192547fd44d6f40d567cd4/e52aa/proxy.jpg 175w\", \"/static/f625463d16192547fd44d6f40d567cd4/70ebb/proxy.jpg 350w\", \"/static/f625463d16192547fd44d6f40d567cd4/29d31/proxy.jpg 700w\", \"/static/f625463d16192547fd44d6f40d567cd4/9ecec/proxy.jpg 1050w\", \"/static/f625463d16192547fd44d6f40d567cd4/e5166/proxy.jpg 1200w\"],\n    \"sizes\": \"(max-width: 700px) 100vw, 700px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(FigureCaption, {\n    caption: \"Using a cache proxy to serve common requests and reduce compute cost from real-time inference\",\n    mdxType: \"FigureCaption\"\n  }), mdx(\"p\", null, \"Another example is using a reverse proxy to serve models. One way to scale is by serving via multiple machines (i.e., horizontal scaling). Nonetheless, we still want to provide a single address for access. A reverse proxy can accept incoming requests via a single address and distribute them across multiple servers to spread the load and ensure low latency.\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"/b80dd82ad7193950405b297e6c895b97/load-balancer.gif\",\n    \"alt\": \"Using a reverse proxy to distribute incoming requests to multiple backend servers\"\n  })), mdx(FigureCaption, {\n    caption: \"Using a reverse proxy to distribute incoming requests to multiple backend servers\",\n    mdxType: \"FigureCaption\"\n  }), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The mediator pattern provides a middleman that restricts direct communication between services\"), \", forcing services to collaborate\\u2014indirectly\\u2014via the mediator. This promotes loose coupling by preventing services from referring to one another explicitly and implementing to the other services' interface.\"), mdx(\"p\", null, \"If there are mediators in our existing systems, we should expect to serve machine learning services through them instead of directly to downstream applications (e.g., e-commerce sites, trade orders). Mediators typically have standard requirements (e.g., request schemas) and constraints (e.g., latency, rate limiting) to adhere to.\"), mdx(\"p\", null, \"For example, we might have multiple recommendation widgets to display on the home page of Netflix. Instead of allowing widgets to decide how they're shown to users, we can require each widget to go through a mediator which ranks the widgets. The mediator may also perform checks (e.g., exclude widgets with less than \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"x\"), \" items) or update widgets (e.g., deduplicate items across multiple widgets).\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"700px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"54.285714285714285%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgABBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAey8QJR//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAIxAf/aAAgBAQABBQLLsFGiz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAQEAAwAAAAAAAAAAAAAAAAEAECFR/9oACAEBAAE/IZfMR24QX//aAAwDAQACAAMAAAAQkA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8QbX//xAAcEAEAAwACAwAAAAAAAAAAAAABABEhUWFxgfD/2gAIAQEAAT8QyAdPuYyu1e4bHzxUBRNGOknUrMMyf//Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Using a mediator to allocate widgets to placements on the home page\",\n    \"title\": \"Using a mediator to allocate widgets to placements on the home page\",\n    \"src\": \"/static/cccff468c27777324be291a39e335a3f/29d31/mediator.jpg\",\n    \"srcSet\": [\"/static/cccff468c27777324be291a39e335a3f/e52aa/mediator.jpg 175w\", \"/static/cccff468c27777324be291a39e335a3f/70ebb/mediator.jpg 350w\", \"/static/cccff468c27777324be291a39e335a3f/29d31/mediator.jpg 700w\", \"/static/cccff468c27777324be291a39e335a3f/9ecec/mediator.jpg 1050w\", \"/static/cccff468c27777324be291a39e335a3f/e5166/mediator.jpg 1200w\"],\n    \"sizes\": \"(max-width: 700px) 100vw, 700px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(FigureCaption, {\n    caption: \"Using a mediator to allocate widgets to placements on the home page\",\n    mdxType: \"FigureCaption\"\n  }), mdx(\"h2\", {\n    \"id\": \"conclusion\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Conclusion\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#conclusion\",\n    \"aria-label\": \"conclusion permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"height\": \"20px\",\n    \"width\": \"20px\",\n    \"style\": {\n      \"verticalAlign\": \"-10%\",\n      \"marginLeft\": \"0.25rem\"\n    },\n    \"fill\": \"#007bff\",\n    \"x\": \"0px\",\n    \"y\": \"0px\",\n    \"viewBox\": \"0 0 100 100\",\n    \"enableBackground\": \"new 0 0 100 52\",\n    \"xmlSpace\": \"preserve\"\n  }, mdx(\"g\", {\n    parentName: \"svg\",\n    \"transform\": \"matrix(0.6136733,-0.6136733,0.6136733,0.6136733,4.0598725,65.6509)\"\n  }, mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 47.807,33.138 c 0.008,-0.009 0.016,-0.019 0.024,-0.026 -0.009,0.007 -0.018,0.015 -0.026,0.023 0,0.001 10e-4,0.002 0.002,0.003 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 53.048,49.8 c -0.274,-0.071 -0.545,-0.152 -0.815,-0.232 -0.002,0.001 -0.005,0.003 -0.007,0.003 0.259,0.077 0.534,0.155 0.822,0.229 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 36.33,35.501 h -0.004 c 0.204,0.522 0.496,1.114 0.783,1.651 h 0.013 c -0.284,-0.54 -0.548,-1.09 -0.792,-1.651 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 37.108,37.152 c 0.291,0.544 0.577,1.029 0.758,1.332 -0.263,-0.436 -0.508,-0.882 -0.746,-1.332 h -0.012 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 38.062,38.804 h 0.006 c -0.048,-0.079 -0.1,-0.152 -0.147,-0.231 0.087,0.144 0.141,0.231 0.141,0.231 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 51.812,49.445 c -0.631,-0.197 -1.249,-0.424 -1.856,-0.669 -0.003,0.002 -0.007,0.003 -0.009,0.004 0.06,0.025 0.781,0.324 1.865,0.665 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 52.226,49.57 c 0.002,0 0.005,-0.002 0.007,-0.003 -0.106,-0.03 -0.213,-0.057 -0.318,-0.091 0.101,0.033 0.205,0.065 0.311,0.094 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"M 74.458,0.955 H 59.321 c -1.307,0 -2.591,0.1 -3.845,0.293 -0.273,0.042 -0.541,0.101 -0.811,0.151 4.646,2.666 8.469,6.605 10.987,11.343 h 1.238 8.346 c 7.322,0 13.257,5.937 13.257,13.259 0,7.321 -5.936,13.258 -13.257,13.258 H 65.72 63.762 61.857 61.851 58.68 c -3.305,0 -6.324,-1.212 -8.646,-3.212 0,0 -0.003,0.003 -0.003,0.003 0,-0.002 -10e-4,-0.002 -0.002,-0.003 -0.494,-0.414 -0.886,-0.802 -1.206,-1.148 -0.7,-0.764 -1.011,-1.303 -1.011,-1.303 0.001,-0.002 0.002,-0.002 0.002,-0.003 -10e-4,-0.001 -0.002,-0.002 -0.002,-0.003 -1.505,-2.15 -2.389,-4.766 -2.389,-7.589 0,-2.746 0.834,-5.296 2.263,-7.413 0.041,-0.06 0.086,-0.117 0.127,-0.176 -1.736,-1.473 -3.978,-2.367 -6.429,-2.367 h -5.041 c -1.325,3.052 -2.067,6.416 -2.067,9.956 0,3.538 0.737,6.903 2.061,9.955 0.244,0.561 0.509,1.111 0.792,1.651 0.237,0.45 0.482,0.896 0.746,1.332 0.02,0.033 0.036,0.059 0.054,0.088 0.047,0.079 0.099,0.152 0.147,0.231 2.792,4.463 6.948,7.98 11.888,9.973 0.608,0.245 1.226,0.472 1.856,0.669 0.034,0.011 0.068,0.022 0.103,0.031 0.105,0.034 0.212,0.061 0.318,0.091 0.27,0.08 0.541,0.161 0.815,0.232 0.004,0 0.006,0.002 0.01,0.003 2,0.513 4.096,0.787 6.254,0.787 H 74.457 C 88.289,51.044 99.501,39.831 99.501,26 99.502,12.169 88.29,0.955 74.458,0.955 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 25.542,51.045 h 15.137 c 1.308,0 2.592,-0.101 3.846,-0.294 0.273,-0.042 0.542,-0.1 0.811,-0.151 C 40.69,47.935 36.866,43.996 34.349,39.258 H 33.11 24.764 c -7.322,0 -13.257,-5.936 -13.257,-13.259 0,-7.322 5.935,-13.257 13.257,-13.257 h 9.516 1.957 1.905 0.007 3.17 c 3.304,0 6.323,1.212 8.645,3.212 l 0.002,-0.003 c 10e-4,10e-4 10e-4,0.002 0.002,0.003 0.495,0.413 0.887,0.801 1.206,1.148 0.701,0.762 1.011,1.302 1.011,1.302 0,0.001 -0.001,0.002 -0.002,0.003 10e-4,0 0.002,0.001 0.003,0.003 1.505,2.15 2.39,4.766 2.39,7.588 0,2.746 -0.835,5.297 -2.264,7.412 -0.041,0.062 -0.085,0.118 -0.127,0.176 1.736,1.474 3.979,2.369 6.429,2.369 h 5.042 c 1.324,-3.053 2.065,-6.417 2.065,-9.957 0,-3.539 -0.737,-6.903 -2.061,-9.955 C 63.416,15.482 63.151,14.932 62.868,14.392 62.631,13.941 62.386,13.494 62.122,13.06 62.102,13.027 62.086,13 62.069,12.971 62.021,12.893 61.97,12.818 61.922,12.741 59.13,8.278 54.973,4.76 50.034,2.768 49.426,2.523 48.808,2.297 48.178,2.098 48.144,2.087 48.11,2.077 48.075,2.066 47.97,2.034 47.863,2.007 47.757,1.977 47.487,1.896 47.216,1.815 46.941,1.745 46.937,1.744 46.935,1.744 46.932,1.743 44.932,1.228 42.837,0.955 40.677,0.955 H 25.542 c -13.832,0 -25.044,11.212 -25.044,25.044 0,13.833 11.212,25.046 25.044,25.046 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"M 53.058,49.803 C 53.055,49.802 53.052,49.8 53.048,49.8 c 0.004,0 0.007,0.002 0.01,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 51.812,49.445 c 0.034,0.011 0.068,0.022 0.103,0.031 -0.034,-0.008 -0.068,-0.02 -0.103,-0.031 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 47.805,33.141 c 0,0 0.311,0.539 1.011,1.303 0.005,-0.006 0.01,-0.012 0.016,-0.015 -0.369,-0.407 -0.709,-0.84 -1.025,-1.291 0,0.001 -0.001,0.001 -0.002,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 37.92,38.572 c -0.018,-0.029 -0.034,-0.055 -0.054,-0.088 0.019,0.03 0.036,0.058 0.054,0.088 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 48.832,34.429 c -0.006,0.003 -0.011,0.009 -0.016,0.015 0.319,0.347 0.711,0.734 1.206,1.148 0.001,-0.002 0.002,-0.003 0.002,-0.003 -0.42,-0.362 -0.82,-0.749 -1.192,-1.16 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 50.027,35.592 c 10e-4,-0.003 0.004,-0.006 0.012,-0.015 -0.004,0.004 -0.01,0.008 -0.015,0.012 10e-4,0 0.002,0.001 0.003,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"rect\", {\n    parentName: \"g\",\n    \"height\": \"0.004007bff2\",\n    \"width\": \"0.004007bff2\",\n    \"y\": \"35.59\",\n    \"x\": \"50.021999\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }))))), mdx(\"p\", null, \"Knowing that something is a factory, decorator, or mediator helps us use them as intended. Conversely, using the right pattern when developing libraries or systems helps users understand our intent. What other common design patterns have you seen in machine learning code and systems? Please \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://twitter.com/eugeneyan\"\n  }, \"reach out\"), \" or comment below!\"), mdx(\"h2\", {\n    \"id\": \"references\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"References\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#references\",\n    \"aria-label\": \"references permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"height\": \"20px\",\n    \"width\": \"20px\",\n    \"style\": {\n      \"verticalAlign\": \"-10%\",\n      \"marginLeft\": \"0.25rem\"\n    },\n    \"fill\": \"#007bff\",\n    \"x\": \"0px\",\n    \"y\": \"0px\",\n    \"viewBox\": \"0 0 100 100\",\n    \"enableBackground\": \"new 0 0 100 52\",\n    \"xmlSpace\": \"preserve\"\n  }, mdx(\"g\", {\n    parentName: \"svg\",\n    \"transform\": \"matrix(0.6136733,-0.6136733,0.6136733,0.6136733,4.0598725,65.6509)\"\n  }, mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 47.807,33.138 c 0.008,-0.009 0.016,-0.019 0.024,-0.026 -0.009,0.007 -0.018,0.015 -0.026,0.023 0,0.001 10e-4,0.002 0.002,0.003 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 53.048,49.8 c -0.274,-0.071 -0.545,-0.152 -0.815,-0.232 -0.002,0.001 -0.005,0.003 -0.007,0.003 0.259,0.077 0.534,0.155 0.822,0.229 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 36.33,35.501 h -0.004 c 0.204,0.522 0.496,1.114 0.783,1.651 h 0.013 c -0.284,-0.54 -0.548,-1.09 -0.792,-1.651 z\",\n    \"style\": {},\n    \"fill\": \"none\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 37.108,37.152 c 0.291,0.544 0.577,1.029 0.758,1.332 -0.263,-0.436 -0.508,-0.882 -0.746,-1.332 h -0.012 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 38.062,38.804 h 0.006 c -0.048,-0.079 -0.1,-0.152 -0.147,-0.231 0.087,0.144 0.141,0.231 0.141,0.231 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 51.812,49.445 c -0.631,-0.197 -1.249,-0.424 -1.856,-0.669 -0.003,0.002 -0.007,0.003 -0.009,0.004 0.06,0.025 0.781,0.324 1.865,0.665 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 52.226,49.57 c 0.002,0 0.005,-0.002 0.007,-0.003 -0.106,-0.03 -0.213,-0.057 -0.318,-0.091 0.101,0.033 0.205,0.065 0.311,0.094 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"M 74.458,0.955 H 59.321 c -1.307,0 -2.591,0.1 -3.845,0.293 -0.273,0.042 -0.541,0.101 -0.811,0.151 4.646,2.666 8.469,6.605 10.987,11.343 h 1.238 8.346 c 7.322,0 13.257,5.937 13.257,13.259 0,7.321 -5.936,13.258 -13.257,13.258 H 65.72 63.762 61.857 61.851 58.68 c -3.305,0 -6.324,-1.212 -8.646,-3.212 0,0 -0.003,0.003 -0.003,0.003 0,-0.002 -10e-4,-0.002 -0.002,-0.003 -0.494,-0.414 -0.886,-0.802 -1.206,-1.148 -0.7,-0.764 -1.011,-1.303 -1.011,-1.303 0.001,-0.002 0.002,-0.002 0.002,-0.003 -10e-4,-0.001 -0.002,-0.002 -0.002,-0.003 -1.505,-2.15 -2.389,-4.766 -2.389,-7.589 0,-2.746 0.834,-5.296 2.263,-7.413 0.041,-0.06 0.086,-0.117 0.127,-0.176 -1.736,-1.473 -3.978,-2.367 -6.429,-2.367 h -5.041 c -1.325,3.052 -2.067,6.416 -2.067,9.956 0,3.538 0.737,6.903 2.061,9.955 0.244,0.561 0.509,1.111 0.792,1.651 0.237,0.45 0.482,0.896 0.746,1.332 0.02,0.033 0.036,0.059 0.054,0.088 0.047,0.079 0.099,0.152 0.147,0.231 2.792,4.463 6.948,7.98 11.888,9.973 0.608,0.245 1.226,0.472 1.856,0.669 0.034,0.011 0.068,0.022 0.103,0.031 0.105,0.034 0.212,0.061 0.318,0.091 0.27,0.08 0.541,0.161 0.815,0.232 0.004,0 0.006,0.002 0.01,0.003 2,0.513 4.096,0.787 6.254,0.787 H 74.457 C 88.289,51.044 99.501,39.831 99.501,26 99.502,12.169 88.29,0.955 74.458,0.955 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 25.542,51.045 h 15.137 c 1.308,0 2.592,-0.101 3.846,-0.294 0.273,-0.042 0.542,-0.1 0.811,-0.151 C 40.69,47.935 36.866,43.996 34.349,39.258 H 33.11 24.764 c -7.322,0 -13.257,-5.936 -13.257,-13.259 0,-7.322 5.935,-13.257 13.257,-13.257 h 9.516 1.957 1.905 0.007 3.17 c 3.304,0 6.323,1.212 8.645,3.212 l 0.002,-0.003 c 10e-4,10e-4 10e-4,0.002 0.002,0.003 0.495,0.413 0.887,0.801 1.206,1.148 0.701,0.762 1.011,1.302 1.011,1.302 0,0.001 -0.001,0.002 -0.002,0.003 10e-4,0 0.002,0.001 0.003,0.003 1.505,2.15 2.39,4.766 2.39,7.588 0,2.746 -0.835,5.297 -2.264,7.412 -0.041,0.062 -0.085,0.118 -0.127,0.176 1.736,1.474 3.979,2.369 6.429,2.369 h 5.042 c 1.324,-3.053 2.065,-6.417 2.065,-9.957 0,-3.539 -0.737,-6.903 -2.061,-9.955 C 63.416,15.482 63.151,14.932 62.868,14.392 62.631,13.941 62.386,13.494 62.122,13.06 62.102,13.027 62.086,13 62.069,12.971 62.021,12.893 61.97,12.818 61.922,12.741 59.13,8.278 54.973,4.76 50.034,2.768 49.426,2.523 48.808,2.297 48.178,2.098 48.144,2.087 48.11,2.077 48.075,2.066 47.97,2.034 47.863,2.007 47.757,1.977 47.487,1.896 47.216,1.815 46.941,1.745 46.937,1.744 46.935,1.744 46.932,1.743 44.932,1.228 42.837,0.955 40.677,0.955 H 25.542 c -13.832,0 -25.044,11.212 -25.044,25.044 0,13.833 11.212,25.046 25.044,25.046 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"M 53.058,49.803 C 53.055,49.802 53.052,49.8 53.048,49.8 c 0.004,0 0.007,0.002 0.01,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 51.812,49.445 c 0.034,0.011 0.068,0.022 0.103,0.031 -0.034,-0.008 -0.068,-0.02 -0.103,-0.031 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 47.805,33.141 c 0,0 0.311,0.539 1.011,1.303 0.005,-0.006 0.01,-0.012 0.016,-0.015 -0.369,-0.407 -0.709,-0.84 -1.025,-1.291 0,0.001 -0.001,0.001 -0.002,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 37.92,38.572 c -0.018,-0.029 -0.034,-0.055 -0.054,-0.088 0.019,0.03 0.036,0.058 0.054,0.088 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 48.832,34.429 c -0.006,0.003 -0.011,0.009 -0.016,0.015 0.319,0.347 0.711,0.734 1.206,1.148 0.001,-0.002 0.002,-0.003 0.002,-0.003 -0.42,-0.362 -0.82,-0.749 -1.192,-1.16 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"path\", {\n    parentName: \"g\",\n    \"d\": \"m 50.027,35.592 c 10e-4,-0.003 0.004,-0.006 0.012,-0.015 -0.004,0.004 -0.01,0.008 -0.015,0.012 10e-4,0 0.002,0.001 0.003,0.003 z\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }), mdx(\"rect\", {\n    parentName: \"g\",\n    \"height\": \"0.004007bff2\",\n    \"width\": \"0.004007bff2\",\n    \"y\": \"35.59\",\n    \"x\": \"50.021999\",\n    \"style\": {},\n    \"fill\": \"#007bff\"\n  }))))), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://en.wikipedia.org/wiki/Design_Patterns\"\n  }, \"Design Patterns: Elements of Reusable Object-Oriented Software\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://www.goodreads.com/book/show/58128.Head_First_Design_Patterns\"\n  }, \"Head First Design Patterns\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://refactoring.guru/design-patterns\"\n  }, \"Refactor Guru Design Patterns\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/msaroufim/ml-design-patterns\"\n  }, \"ml-design patterns (Mark Saroufim)\"))));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"slug":"/resources/patterns/"}},
    "staticQueryHashes": ["3159585216","3897982121"]}